SELECT YEAR(S.SALES_DATE) AS YEAR,
       MONTH(S.SALES_DATE) AS MONTH,
       COUNT(DISTINCT U.USER_ID) AS PURCHASED_USERS,
      ROUND( COUNT(DISTINCT U.USER_ID)/(SELECT COUNT(USER_ID)
                        FROM USER_INFO A
                        WHERE YEAR(A.JOINED)='2021'
                       ),1) AS PUCHASED_RATIO
FROM USER_INFO U
JOIN ONLINE_SALE S
  ON S.USER_ID=U.USER_ID
WHERE YEAR(U.JOINED)='2021'
GROUP BY YEAR(S.SALES_DATE), MONTH(S.SALES_DATE)
ORDER BY YEAR(S.SALES_DATE), MONTH(S.SALES_DATE)